<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
    <title>Movie Details - Peppam.tv</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="https://cdn.plyr.io/3.7.8/plyr.css" />
    
    <link rel="stylesheet" href="style.css"> 

    <style>
        /* Apply Poppins to all relevant elements on the page */
        body, .movie-detail-main, .vlc-button {
            font-family: 'Poppins', sans-serif;
        }

        /* The 16:9 Container */
        .player-container {
            width: 100%;
            aspect-ratio: 16 / 9;
            background: #000;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0,0,0,0.5);
            margin-top: 20px; /* Spacing from details */
        }

        /* --- THEME CUSTOMIZATION --- */
        :root {
            --main-yellow: #ffff00; /* Neon Yellow */
        }

        .plyr {
            font-family: 'Poppins', sans-serif;
            --plyr-color-main: var(--main-yellow);
            --plyr-video-control-color: #ffffff; 
            --plyr-video-control-color-hover: var(--main-yellow);
            --plyr-menu-background: #111;
            --plyr-menu-color: #fff;
        }

        /* Big Play Button (Center) */
        .plyr__control--overlaid {
            background: var(--main-yellow); 
            color: #000; 
        }
        .plyr__control--overlaid:hover {
            background: #e6e600;
        }

        /* Timeline Scrubber Handle */
        .plyr__range--seek::-webkit-slider-thumb {
            background: var(--main-yellow) !important;
            box-shadow: 0 0 8px rgba(255, 255, 0, 0.6) !important;
        }

        /* Tooltips */
        .plyr__tooltip {
            background: var(--main-yellow) !important;
            color: #000 !important;
            font-family: 'Poppins', sans-serif !important;
            font-weight: 600;
            border-radius: 4px;
        }
        
        .plyr__time {
            font-family: 'Poppins', sans-serif;
            font-weight: 500;
        }
        
        /* New VLC Button Style */
        .vlc-button-container {
            /* Increased margin for more space between player and button */
            margin-top: 30px; 
            text-align: center;
        }

        .vlc-button {
            background-color: #ff8800; /* VLC-like orange */
            color: #fff;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            box-shadow: 0 4px 10px rgba(255, 136, 0, 0.4);
            text-decoration: none;
        }

        .vlc-button:hover {
            background-color: #e67a00;
        }

        .vlc-button img {
            width: 20px;
            height: 20px;
            filter: invert(1); /* Invert for better visibility on orange */
        }
    </style>
</head>
<body class="movie-detail-page">

    <header class="detail-header">
        <nav class="detail-nav">
            <button class="menu-icon" id="menu-toggle" aria-label="Menu">‚ò∞</button>
            <a href="index.html" class="logo">
                <h1><span class="peppam">Peppam</span><span class="tv">.tv</span></h1>
            </a>
            <a href="index.html?search=true" class="search-icon" aria-label="Search">üîç</a>
        </nav>
    </header>

    <div class="sidebar" id="sidebar">
        <div class="sidebar-overlay" id="sidebar-overlay"></div>
        <div class="sidebar-content">
            <button class="sidebar-close" id="sidebar-close">√ó</button>
            <ul class="sidebar-menu">
                <li><a href="index.html">Home</a></li>
                <li><a href="about.html">About</a></li>
                <li><a href="contact.html">Contact</a></li>
            </ul>
        </div>
    </div>

    <main class="movie-detail-main">
        <div class="movie-detail-wrapper">
            <div class="movie-poster-section">
                <div class="movie-poster">
                    <img id="movie-poster" src="" alt="Movie Poster">
                </div>
            </div>

            <div class="movie-info-section">
                <h1 class="detail-movie-title" id="movie-title">Loading...</h1>

                <div class="movie-meta">
                    <div class="meta-item">
                        <span class="meta-label">Year:</span>
                        <span class="meta-value" id="movie-year">-</span>
                    </div>
                    <div class="meta-item">
                        <span class="meta-label">Genre:</span>
                        <span class="meta-value" id="movie-genre">-</span>
                    </div>
                    <div class="meta-item">
                        <span class="meta-label">üë§ Cast:</span>
                        <span class="meta-value" id="movie-cast">-</span>
                    </div>
                    <div class="meta-item">
                        <span class="meta-label">üë§ Director:</span>
                        <span class="meta-value" id="movie-director">-</span>
                    </div>
                </div>

                <div class="player-container">
                    <video id="player" playsinline crossorigin></video>
                </div>
                
                <div class="vlc-button-container">
                    <button class="vlc-button" id="vlc-player-button">
                        <img src="https://i.postimg.cc/15TQ4y7B/vlc.png" alt="VLC Logo">
                        WATCH IN VLC PLAYER
                    </button>
                </div>

            </div>
        </div>

        <div class="synopsis-section">
            <h2 class="synopsis-title">Synopsis</h2>
            <p class="synopsis-text" id="movie-synopsis">
                Loading movie information...
            </p>
        </div>

        <div class="streaming-info">
            <p id="movie-streaming-info">
                Loading streaming information...
            </p>
        </div>
    </main>

    <script src="script.js"></script>
    <script src="https://cdn.plyr.io/3.7.8/plyr.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>

    <script>
        // Movie database (Updated with videoSource)
        // Replace the dummy URLs with your actual m3u8 links
        const movies = {
            'telusu-kada': {
                title: 'Telusu Kada',
                year: '2024',
                genre: 'Action / Thriller',
                cast: 'Naveen Polishetty, Anjali, Priyadarshi',
                director: 'Vivek Athreya',
                poster: 'https://upload.wikimedia.org/wikipedia/en/a/ae/Telusu_Kada.jpg',
                synopsis: 'Telusu Kada is an action-packed thriller that follows the journey of a young man who gets entangled in a web of crime and mystery.',
                streamingInfo: 'Telusu Kada movie in Telugu streaming in HD Quality.',
                videoSource: 'http://love.stranger-things.buzz/b8514b757bda9efbde57b335259d891c?token=1764173674147'
            },
            'kaantha': {
                title: 'Kaantha',
                year: '2024',
                genre: 'Drama / Romance',
                cast: 'Sai Pallavi, Naga Chaitanya, Priyamani',
                director: 'Sekhar Kammula',
                poster: 'https://upload.wikimedia.org/wikipedia/en/9/91/Kaantha.jpg',
                synopsis: 'Kaantha is a heartwarming drama that explores the complexities of relationships and love.',
                streamingInfo: 'Kaantha movie in Telugu streaming in HD Quality.',
                videoSource: 'https://test-streams.mux.dev/x36xhzz/x36xhzz.m3u8'
            },
            'k-ramp': {
                title: 'K-Ramp',
                year: '2024',
                genre: 'Action / Crime',
                cast: 'Ravi Teja, Sreeleela, Jayaram',
                director: 'Gopichand Malineni',
                poster: 'https://upload.wikimedia.org/wikipedia/en/4/46/K-Ramp.jpg',
                synopsis: 'K-Ramp is a high-octane action thriller that follows a fearless cop who takes on a dangerous criminal organization.',
                streamingInfo: 'K-Ramp movie in Telugu streaming in HD Quality.',
                videoSource: 'https://test-streams.mux.dev/x36xhzz/x36xhzz.m3u8'
            },
            'dude': {
                title: 'Dude',
                year: '2024',
                genre: 'Comedy / Drama',
                cast: 'Vijay Deverakonda, Rashmika Mandanna',
                director: 'Puri Jagannadh',
                poster: 'https://imgs.search.brave.com/jnPIXuoYFRMPpiPCZvD6Uoo-jyvWAwQnpWyvTUB91rA/rs:fit:860:0:0:0/g:ce/aHR0cHM6Ly9pbWdz/LnNlYXJjaC5icmF2/ZS5jb20vd2dsR3FW/NWZDVGZ6emNVZHZp/WHFCZzFqc25ZZEtQ/OVJiS2ZRclFlR3Jn/dy9yczpmaXQ6NTAw/OjA6MDowL2c6Y2Uv/YUhSMGNITTZMeTl3/Y21WMi9hV1YzTG5K/bFpHUXVhWFF2L1pI/VmtaUzF5WlhacFpY/Y3QvYldWbllYUm9j/bVZoWkMxMi9NQzFr/T1hSeFlqRjBOSFpu/L2RtWXhMbXB3Wldj/X2QybGsvZEdnOU5q/UXdKbU55YjNBOS9j/MjFoY25RbVlYVjBi/ejEzL1pXSndKbk05/TWpWa05EVTAvTVRk/aE5UVXlNbUV5WVdV/Mi9NekZpTmpnNU1U/TXhaV1k1L01XRTNP/REUzTURNMk5R',
                synopsis: 'Dude is a coming-of-age comedy-drama that follows the life of a carefree young man.',
                streamingInfo: 'Dude movie in Telugu streaming in HD Quality.',
                videoSource: 'https://test-streams.mux.dev/x36xhzz/x36xhzz.m3u8'
            },
            'vikkatakavi': {
                title: 'Vikkatakavi',
                year: '2024',
                genre: 'Drama / Biography',
                cast: 'Nani, Keerthy Suresh, Prakash Raj',
                director: 'Krishna Vamsi',
                poster: 'https://imgs.search.brave.com/qpRqyYr8Y_T-8qE7_x6V6glhCobiJ4AtuOtjW4rwCQg/rs:fit:860:0:0:0/g:ce/aHR0cHM6Ly91cGxv/YWQud2lraW1lZGlh/Lm9yZy93aWtpcGVk/aWEvZW4vZi9mZC9W/aWtrYXRha2F2aS5q/cGVn',
                synopsis: 'Vikkatakavi is an inspiring biographical drama that tells the story of a legendary poet.',
                streamingInfo: 'Vikkatakavi movie in Telugu streaming in HD Quality.',
                videoSource: 'https://test-streams.mux.dev/x36xhzz/x36xhzz.m3u8'
            },
            'mithra-mandali': {
                title: 'Mithra Mandali',
                year: '2025',
                genre: 'Action / Thriller',
                cast: 'Allu Arjun, Pooja Hegde, Fahadh Faasil',
                director: 'Trivikram Srinivas',
                poster: 'https://imgs.search.brave.com/onNcOmctUaPvCN9dwT4Rp8MXEyCL2h-boLsGFfzSjiQ/rs:fit:860:0:0:0/g:ce/aHR0cHM6Ly9tZWRp/YS5yYWdhbGFoYXJp/LmNvbS9uZXdzL2p1/bjIwMjUvbWl0aHJh/LW1hbmRhbGktZmly/c3QtbG9vay1wb3N0/ZXItb3V0LWp1bjYu/anBn',
                synopsis: 'Mithra Mandali is an action-packed thriller that follows a group of friends.',
                streamingInfo: 'Mithra Mandali movie in Telugu streaming in HD Quality.',
                videoSource: 'https://test-streams.mux.dev/x36xhzz/x36xhzz.m3u8'
            }
        };

        // Get movie ID from URL parameter
        function getMovieIdFromURL() {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get('id') || 'telusu-kada'; 
        }

        // Function to Initialize Player
        function loadPlayer(sourceUrl) {
            const video = document.getElementById('player');
            
            const playerConfig = {
                controls: [
                    'play-large', 'play', 'progress', 'mute', 'volume', 'fullscreen'
                ],
                ratio: '16:9',
                keyboard: { focused: true, global: true },
                tooltips: { controls: true, seek: true }
            };

            // HLS (m3u8) support logic
            if (Hls.isSupported() && sourceUrl.endsWith('.m3u8')) {
                const hls = new Hls();
                hls.loadSource(sourceUrl);
                hls.attachMedia(video);
                hls.on(Hls.Events.MANIFEST_PARSED, function() {
                    window.player = new Plyr(video, playerConfig);
                });
            } else {
                // For direct MP4 or other links, or if HLS isn't supported
                video.src = sourceUrl;
                window.player = new Plyr(video, playerConfig);
            }
        }

        // Load movie data
        function loadMovieData() {
            const movieId = getMovieIdFromURL();
            const movie = movies[movieId];

            if (!movie) {
                window.location.href = 'index.html';
                return;
            }

            // Update page content
            document.title = `${movie.title} - Peppam.tv`;
            document.getElementById('movie-title').textContent = movie.title;
            document.getElementById('movie-year').textContent = movie.year;
            document.getElementById('movie-genre').textContent = movie.genre;
            document.getElementById('movie-cast').textContent = movie.cast;
            document.getElementById('movie-director').textContent = movie.director;
            document.getElementById('movie-poster').src = movie.poster;
            document.getElementById('movie-poster').alt = `${movie.title} Movie Poster`;
            document.getElementById('movie-synopsis').textContent = movie.synopsis;
            document.getElementById('movie-streaming-info').textContent = movie.streamingInfo;

            // LOAD THE PLAYER FOR THIS SPECIFIC MOVIE
            if(movie.videoSource) {
                loadPlayer(movie.videoSource);
                
                // --- VLC BUTTON LOGIC (Direct Protocol Launch Attempt) ---
                const vlcButton = document.getElementById('vlc-player-button');
                const videoSourceUrl = movie.videoSource;
                
                vlcButton.onclick = function() {
                    // Attempt to launch VLC using the custom URI scheme (vlc://)
                    // Note: This often requires user confirmation or fails in modern browsers.
                    const vlcProtocolUrl = `vlc://${videoSourceUrl}`;
                    window.location.href = vlcProtocolUrl;
                    
                    // Optional: Inform the user of the attempt and provide a manual fallback
                    setTimeout(() => {
                        // Attempt to copy the URL to the clipboard if possible
                        if (navigator.clipboard && navigator.clipboard.writeText) {
                            navigator.clipboard.writeText(videoSourceUrl).then(() => {
                                alert(`Attempting to launch VLC with stream: ${videoSourceUrl}\n\nThe URL has been copied to your clipboard. If VLC doesn't open automatically, please paste the link into VLC's "Open Network Stream" window.`);
                            }).catch(() => {
                                alert(`Attempting to launch VLC with stream: ${videoSourceUrl}\n\nIf it doesn't open, please manually copy the link above and paste it into VLC's "Open Network Stream" window.`);
                            });
                        } else {
                            alert(`Attempting to launch VLC with stream: ${videoSourceUrl}\n\nIf it doesn't open, please manually copy the link above and paste it into VLC's "Open Network Stream" window.`);
                        }
                    }, 500); 
                };
                
            } else {
                console.log("No video source found for this movie.");
            }
        }

        // Load movie data when page loads
        window.addEventListener('DOMContentLoaded', loadMovieData);

        // Sidebar functionality (assuming 'script.js' defines the initial CSS state)
        const menuToggle = document.getElementById('menu-toggle');
        const sidebar = document.getElementById('sidebar');
        const sidebarClose = document.getElementById('sidebar-close');
        const sidebarOverlay = document.getElementById('sidebar-overlay');

        menuToggle.addEventListener('click', () => {
            sidebar.classList.add('active');
        });
        sidebarClose.addEventListener('click', () => {
            sidebar.classList.remove('active');
        });
        sidebarOverlay.addEventListener('click', () => {
            sidebar.classList.remove('active');
        });
    </script>
</body>
</html>
